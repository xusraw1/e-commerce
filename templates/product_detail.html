{% extends 'base.html' %}


{% block title %} {{ product.title }} {% endblock %}


{% block content %}
    <!-- Product Detail Start -->
    <div class="container">
        <div class=" w-100 mt-5 ">
            <div class="row shadow-sm ">
                <div class="col-4 p-3">
                    <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-inner">
                            {% for img in product.productimage_set.all %}
                                {% if img == product.productimage_set.first %}
                                    <div class="carousel-item active thumbnail shadow-sm ">
                                        <img class="d-block w-100 " width="400" height="270" src="{{ img.image.url }}">
                                    </div>
                                {% else %}
                                    <div class="carousel-item thumbnail shadow-sm">
                                        <img class="d-block w-100  " width="400" height="270" src="{{ img.image.url }}">
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions"
                                data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions"
                                data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>
                <div class="col-7 p-5 ">
                    <h4>{{ product.title }}</h4>
                    <p class="test-muted"><a
                            href="{% url 'profile' product.author.username %}">@{{ product.author.username }}</a> |
                        {{ product.date }}</p>
                    <p>{{ product.description }}</p>
                    <div class="contact mt-4 ">
                        {% if request.user == product.author %}
                            <a class="btn btn-warning" href="{% url 'update' product.id %}">Edit details</a>
                        {% endif %}
                        <a class="btn btn-primary" href="mailto:{{ product.author.email }}">Email</a>
                        <a class="btn btn-primary" href="tel:{{ product.number }}">Call</a>
                        <a class="btn btn-primary" href="https://t.me/{{ product.telegram }}">Telegram</a>
                    </div>
                </div>
            </div>
            <div class="row ">
                <div class="col-8 mt-5">
                    <h6>In {{ product.category }} category</h6>
                    <div class="d-flex flex-wrap justify-content-between">
                        {% for i in product.category.product_set.all %}
                            {% if product != i %}
                                <div class="card border border-0 shadow-sm d-inline-block m-1 mt-3"
                                     style="width: 14rem;">
                                    <img height="190" class=" card-img-top"
                                         src="{{ i.productimage_set.all.first.image.url }}" alt="">
                                    <div class="card-body">
                                        <h6 class="align-center card-title">{{ i.title }}</h6>
                                        <span class="center card-text">${{ i.price }}</span>
                                        <div class="buttons d-flex flex-wrap justify-content-between ">
                                            <i class="bi bi-bookmark-fill"></i>
                                            <a href="{% url 'product' i.id %}"
                                               class="btn btn-outline-primary">Details</a>
                                        </div>
                                    </div>
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
                <div class="col-4 mt-5 shadow-sm ">
                    <h6 class="pt-2">Add comment</h6>
                    <form action="{% url 'coment' product.id %}" method="post" class="input-group">
                        {% csrf_token %}
                        <input class="form-control" name="body" type="text" placeholder="Type your comment..."
                               aria-describedby="'button-addon">
                        <button class="btn btn-outline-success" type="submit" id="button-addon">Send</button>
                    </form>
                    <hr>
                    <h6>Comments</h6>
                    {% for i in product.comment_set.all %}
                        <small class="text-muted"><a
                                href="{% url 'profile' i.author.username %}"><b>@{{ i.author.username }}</b></a>
                            | {{ i.date }}</small>
                        <p>{{ i.text }}
                            {% if request.user == i.author %}
                                <small><a
                                        href="{% url 'comment_delete' product.id i.id %}">delete</a></small>
                            {% endif %}
                        </p>
                    {% endfor %}
                </div>
            </div>

        </div>
    </div>
    <!-- Product Detail End -->
{% endblock %}